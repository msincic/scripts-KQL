# Scripts KQL to use in Resource graph and Log Analytics
Public KQL Scripts

This is a samples of scripts to use in security and compliance activities
<Table>
  <thead>
    <tr>
      <td>Script name</td>
      <td>Type</td>
      <td>Purpose</td>
    </tr>
  </thead>
  <tbody>

  <tr><td>Agents_Last_Comm</td><td>Log Analytics</td><td>List type of agent (MMA or AMA) and last communication of all computers monitored</td></tr>
  <tr><td>Array-Text-Extract</td><td>Log Analytics</td><td>Examples of extract data in arrays or text columns</td></tr>
  <tr><td>Attack-Examples</td><td>Log Analytics</td><td>Example of detect attacks in logs (SQL Injection)</td></tr>
  <tr><td>Emails-Threat-Intel</td><td>Log Analytics</td><td>Detect malicious IPs and domains in email, URL or sender</td></tr>
  <tr><td>Events_Chart_ByDay</td><td>Log Analytics</td><td>Example of chat to detect anomolous events registered</td></tr>
  <tr><td>Graph_examples</td><td>Log Analytics</td><td>Examples of graph (bar, time, pie)</td></tr>
  <tr><td>List_CWPP</td><td>Resource Graph</td><td>List workload protections in all subscriptions to map a coverage protection in your environment</td></tr>
  <tr><td>M365_Operations</td><td>Log Analytics</td><td>List operations in M365 and IP/DLP actions</td></tr>
  <tr><td>More-Changed-Computers</td><td>Log Analytics</td><td>List top 10 computers and users with changed configs</td></tr>
  <tr><td>PIM_Included</td><td>Log Analytics</td><td>List activities of include users in PIM</td></tr>
  <tr><td>PoliciesAssigned-State</td><td>Resource Graph</td><td>List policies applied and compliance states. You can filter for compliance or non-compliance to addresses actions</td></tr>
  <tr><td>Policies-List</td><td>Resource Graph</td><td>List policies and details to export and use for determine assigments in your enviromnent</td></tr>
  <tr><td>Purview-IP-Events</td><td>Log Analytics</td><td>List all activities in Purview (IP, DLP, IRM, etc)</td></tr>
  <tr><td>Tables-Ingest-Day-by-Day</td><td>Log Analytics</td><td>List ingest data in all tables by day with indicator of billied or non-billed</td></tr>
  <tr><td>ThreatIntel-Examples</td><td>Log Analytics</td><td>Samples to use Microsoft Defender Threat Intel table to detect malicious IP in sign-ins and consult tables</td></tr>
  <tr><td>Usage_Tables</td><td>Log Analytics</td><td>Graph to identify and understand tables growing</td></tr>
  <tr><td>VM_Process_Comm</td><td>Log Analytics</td><td>List of process communicated in all computers with IP and Port, source, destination, bytes send and received</td></tr>

  </tbody>
</Table>

<h3>If you have a question, send me email msincic @ microsoft.com</h3>
